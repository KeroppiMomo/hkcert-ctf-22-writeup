# Ring (香港回歸紀念塔)
> Tag: reverse, 2-star, 150 points
>
> Attachment: [ring_a501a9f8b3512276993a430dc725e721.zip](https://file.hkcert22.pwnable.hk/ring_a501a9f8b3512276993a430dc725e721.zip)

## Challenge Description
The attachment of the challenge is a paragraph of code from the programming language R.
Once the code is executed, users are required to input a correct password in order to get the flag.

## Code Analysis
From the source code line 15 ~ 26, we can see that in order to get the flag, the password entered must somehow makes the values for variables `u` and `v` to be identical.
Otherwise, string "Wrong Password" will be generated.

We tested the code as follows:
- From the source code line 1 & 26, it can also be seen that the password inputted will be regarded as the value for variable `p`.
- A random 17-word string is first inputted into variable `p` by `p <- "asdfghjklqwertyui"`.
- It was then to input `y <- utf8ToInt(p)` to find that `y` returns the ASCII values of indiviudual characters from the variable `p`.
- `z <- lm(y ~ poly(x,16))` is then inputted and according to the [documentation](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/poly),
`z` contains the coefficients of orthogonal polynomials of degree 16 to degree over the specified set of points `x` according to the values of `y` previously mentioned.
- By utilizing the function `predict(z)`, it is found that `z` returns the exact same values as variable `y`.
- We then analyse the coefficients of the polynomial generated by `z` using polynomial regression with the command `(z)$coefficients`.

## Solution
As the ultimate goal is to make variables `u` and `v` store the same value,
coefficients of polynomials in `z` must have the same value as those real numbers in variable `v` that are provided in the source code from line 8 ~ 14.

Therefore, we can predict the string for `p` using
```r
z$coefficients <- v
predict(z)
```
The following values are returned:
```
82 101 103 114 101  83  83  83 105 111 110  77 101  97 110  37 115
```
which should be the value of `y`.

By converting the values returned back into characters using an ASCII table, we were able to find that the string for variable `p` is `RegreSSSionMean%s`.
We then input the string as the password and the flag is returned.

## Flag
```
hkcert22{RegreSSSionMeanReveRseengineeRing}
```
